// https://github.com/grafana/agent-configurator

logging {
	level  = coalesce(env("AGENT_LOG_LEVEL"), "info")
	format = "logfmt"
}

/********************************************
 * LGTMP Receiver provider
 ********************************************/

module.file "docker_compose" {
	filename = coalesce(env("AGENT_CONFIG_FOLDER"), "/etc/agent-config") + "/modules/docker_compose.river"

	arguments {
		profiles_endpoint = "http://gateway:4040"
	}
}

/********************************************
 * Profiles
 ********************************************/

module.file "profiles_primary" {
	filename = coalesce(env("AGENT_CONFIG_FOLDER"), "/etc/agent-config") + "/modules/docker/profiles/all.river"

	arguments {
		forward_to = [module.file.docker_compose.exports.profiles_receiver]
		clustering = true
	}
}
